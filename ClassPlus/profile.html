<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="js/navbar.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="static/css/style.css">
    <link rel="stylesheet" type="text/css" href="webtheme.css">
</head>

<body>
<script>
    $.get("navbar.html", function(data){
        $("#nav-placeholder").replaceWith(data);
    });
</script>
<div id="nav-placeholder"></div>
    <!--Back Button-->
    <div style="left: 15px; top: 124px; position: absolute; justify-content: flex-start; align-items: flex-start; display: inline-flex">
        <a href="javascript:void(0);" onclick="window.history.back();" style="text-decoration: none;">
            <div style="padding-left: 16px; padding-right: 16px; padding-top: 10px; padding-bottom: 10px; background: #004F34; border-radius: 4px; justify-content: flex-start; align-items: center; display: flex">
                <div style="text-align: center; color: #F5F5F5; font-size: 16px; font-family: Inter; font-weight: 600; word-wrap: break-word">Back</div>
            </div>
        </a>
    </div>  


    <div style="width: 348px; height: 182px; left: 100px; top: 200px; position: absolute">
        <div
            style="width: 348px; height: 42px; padding-left: 16px; padding-right: 16px; padding-top: 8px; padding-bottom: 8px; left: 0px; top: 46px; position: absolute; background: white; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
            <a href="profile_ci.html">
            <div
                style="color: #343A40; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 16px; word-wrap: break-word">
                Class Information</div></a>
        </div>
        <div
            style="width: 348px; height: 42px; padding-left: 16px; padding-right: 16px; padding-top: 8px; padding-bottom: 8px; left: 0px; top: 92px; position: absolute; background: white; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
            <a href="profile_fl.html">
            <div
                style="color: #343A40; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 16px; word-wrap: break-word">
                Friend List</div></a>
        </div>
        <div
            style="width: 348px; height: 42px; padding-left: 16px; padding-right: 16px; padding-top: 8px; padding-bottom: 8px; left: 0px; top: 140px; position: absolute; background: white; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
            <a href="profile_cp.html">
            <div
                style="color: #343A40; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 16px; word-wrap: break-word">
                Change Password</div></a>
        </div>
        <div
            style="width: 348px; height: 41px; padding-left: 16px; padding-right: 16px; padding-top: 8px; padding-bottom: 8px; left: 0px; top: 0px; position: absolute; background: #004F34; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: inline-flex">
            <a href="profile.html">
            <div
                style="width: 111px; color: white; font-size: 14px; font-family: Inter; font-weight: 700; line-height: 16px; word-wrap: break-word">
                Information</div></a>
        </div>
    </div>


    <div
        style="width: 270px; height: 262px; left: 500px; top: 174px; position: absolute; background: #D9D9D9; border-radius: 9999px">
    </div>
    <div
        style="left: 579px; top: 291px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        user picture</div>
    <div
        style="left: 832px; top: 170px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        First Name</div>
    <div
        style="left: 832px; top: 472px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Major</div>
    <div
        style="left: 832px; top: 566px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Minor</div>
    <div
        style="left: 832px; top: 654px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Status</div>
    <div
        style="left: 530px; top: 444px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Change profile picture</div>
    <div
        style="left: 832px; top: 373px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Email Address</div>
    <div
        style="left: 832px; top: 274px; position: absolute; color: black; font-size: 20px; font-family: Inter; font-weight: 400; line-height: 28px; word-wrap: break-word">
        Last Name</div>
    <div
        style="left: 797px; top: 787px; position: absolute; justify-content: flex-start; align-items: flex-start; display: inline-flex">
        <div
            style="padding-left: 16px; padding-right: 16px; padding-top: 10px; padding-bottom: 10px; background: #004F34; border-radius: 4px; justify-content: flex-start; align-items: center; display: flex">
            <div
                style="text-align: center; color: #F5F5F5; font-size: 16px; font-family: Inter; font-weight: 600; word-wrap: break-word">
                Save</div>
        </div>
    </div>


    <div
        style="height: 38px; left: 832px; top: 208px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 6px; display: inline-flex">
        <div
            style="align-self: stretch; padding-left: 16px; padding-right: 16px; padding-top: 9px; padding-bottom: 9px; background: #D9D9D9; border-radius: 6px; border: 1px #D9D9D9 solid; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            
            <input type="text" id="firstName" class="userInput">
        </div>
    </div>
    <div
        style="height: 38px; left: 832px; top: 305px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 6px; display: inline-flex">
        <div
            style="align-self: stretch; padding-left: 16px; padding-right: 16px; padding-top: 9px; padding-bottom: 9px; background: #D9D9D9; border-radius: 6px; border: 1px #D9D9D9 solid; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            
            <input type="text" id="lastName" class="userInput">
        </div>
    </div>
    <div
        style="height: 38px; left: 832px; top: 597px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 6px; display: inline-flex">
        <div
            style="align-self: stretch; padding-left: 16px; padding-right: 16px; padding-top: 9px; padding-bottom: 9px; background: #D9D9D9; border-radius: 6px; border: 1px #D9D9D9 solid; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            <input type="text" id="minor" class="userInput">
        </div>
    </div>
    <div
        style="height: 38px; left: 832px; top: 509px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 6px; display: inline-flex">
        <div
            style="align-self: stretch; padding-left: 16px; padding-right: 16px; padding-top: 9px; padding-bottom: 9px; background: #D9D9D9; border-radius: 6px; border: 1px #D9D9D9 solid; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            <input type="text" id="major" class="userInput">
        </div>
    </div>
    <div
        style="height: 38px; left: 832px; top: 407px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 6px; display: inline-flex">
        <div
            style="align-self: stretch; padding-left: 16px; padding-right: 16px; padding-top: 9px; padding-bottom: 9px; background: #D9D9D9; border-radius: 6px; border: 1px #D9D9D9 solid; justify-content: flex-start; align-items: center; gap: 8px; display: inline-flex">
            <input type="text" id="email" class="userInput">
        </div>
    </div>
    
    <div
        style="left: 832px; top: 685px; position: absolute; justify-content: flex-start; align-items: center; display: inline-flex">
        <div style="padding: 8px; justify-content: flex-start; align-items: flex-start; gap: 8px; display: flex">
            <div style="width: 16px; height: 16px; position: relative">
                <input type="radio" id="isStudent" name="userStatus" value="Student">
            </div>
            <label for="isStudent">Student</label>
        </div>
    </div>
    <div
        style="left: 933px; top: 685px; position: absolute; justify-content: flex-start; align-items: center; display: inline-flex">
        <div style="padding: 8px; justify-content: flex-start; align-items: flex-start; gap: 8px; display: flex">
            <div style="width: 16px; height: 16px; position: relative">
                <input type="radio" id="isInstructor" name="userStatus" value="instructor">
            </div>
            <label for="isInstructor">Instructor</label><br>
        </div>
    </div>
    <div
        style="left: 1048px; top: 685px; position: absolute; justify-content: flex-start; align-items: center; display: inline-flex">
        <div style="padding: 8px; justify-content: flex-start; align-items: flex-start; gap: 8px; display: flex">
            <div style="width: 16px; height: 16px; position: relative">
                <input type="checkbox" id="isTa" name="userStatus" value="ta" disabled>
            </div>
            <label for="isTa">TA</label>
        </div>
    </div>


    <script>
        function isTokenValid() {  
            const token = localStorage.getItem('jwt'); 
            const exp = localStorage.getItem('exp');

            if (!token) {
                console.log("No token");
                return false;
            }
            try {
                if (Date.now() >= exp * 1000) {
                    console.log("Token is expired");
                    localStorage.removeItem("jwt");
                    localStorage.removeItem("exp");
                    localStorage.removeItem("firstName");
                    localStorage.removeItem("lastName");
                    location.replace('/');
                    return false;
                }
            } catch (err) {
                console.log("Token is invalid");
                return false;
            }
            return true;
        }

        function onLoad() {
            const token = localStorage.getItem('jwt');
            const exp = localStorage.getItem('exp');
            const userId = 4;

            isTokenValid();
            axios.get(`/api/profile/${userId}`, {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            }).then(res => {
                console.log(res.data);

                document.querySelector('#firstName').value = res.data[0].firstName;
                document.querySelector('#lastName').value = res.data[0].lastName;
                document.querySelector('#email').value = res.data[0].email;
                document.querySelector('#major').value = res.data[0].major;
                document.querySelector('#minor').value = res.data[0].minor;

                localStorage.setItem('firstName', res.data[0].firstName);
                localStorage.setItem('lastName', res.data[0].lastName);

                if(res.data[0].isStudent == 1){
                    document.querySelector('#isStudent').checked = true;
                }
                if(res.data[0].isInstructor == 1){
                    document.querySelector('#isInstructor').checked = true;
                }
                if(res.data[0].isTa == 1){
                    document.querySelector('#isTa').checked = true;
                }
            })         
        }

        onLoad();
    </script>
</body>

</html>
